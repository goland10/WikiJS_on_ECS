<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wiki.js AWS Architecture</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:wght@300;400;600&display=swap');

  :root {
    --bg: #0a0e1a;
    --surface: #111827;
    --border: #1e2d45;
    --accent: #00d4ff;
    --accent2: #ff6b35;
    --accent3: #00ff9d;
    --accent4: #a855f7;
    --text: #e2e8f0;
    --muted: #64748b;
    --az1: rgba(0, 212, 255, 0.04);
    --az2: rgba(168, 85, 247, 0.04);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'IBM Plex Sans', sans-serif;
    min-height: 100vh;
    padding: 32px 24px;
    background-image:
      radial-gradient(ellipse at 20% 10%, rgba(0,212,255,0.06) 0%, transparent 50%),
      radial-gradient(ellipse at 80% 90%, rgba(168,85,247,0.06) 0%, transparent 50%);
  }

  header {
    text-align: center;
    margin-bottom: 36px;
  }

  header h1 {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--accent);
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 6px;
  }

  header p {
    font-size: 0.8rem;
    color: var(--muted);
    font-family: 'IBM Plex Mono', monospace;
  }

  .diagram {
    max-width: 980px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  /* ===== VPC WRAPPER ===== */
  .vpc {
    border: 1.5px solid #1e4a7a;
    border-radius: 16px;
    padding: 20px;
    position: relative;
    background: rgba(14, 26, 46, 0.6);
  }

  .zone-label {
    position: absolute;
    top: -11px;
    left: 20px;
    background: var(--bg);
    padding: 0 10px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.68rem;
    font-weight: 600;
    color: #1e6fa8;
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  /* ===== TIERS ===== */
  .tier-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-bottom: 14px;
  }

  .tier-row.single { grid-template-columns: 1fr; }
  .tier-row.triple { grid-template-columns: 1fr 1fr 1fr; }

  .subnet {
    border: 1px dashed;
    border-radius: 10px;
    padding: 14px;
    position: relative;
  }

  .subnet.public {
    border-color: rgba(0, 212, 255, 0.3);
    background: rgba(0, 212, 255, 0.03);
  }

  .subnet.private-app {
    border-color: rgba(0, 255, 157, 0.25);
    background: rgba(0, 255, 157, 0.02);
  }

  .subnet.private-db {
    border-color: rgba(255, 107, 53, 0.25);
    background: rgba(255, 107, 53, 0.02);
  }

  .subnet-label {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.62rem;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .subnet.public .subnet-label { color: rgba(0, 212, 255, 0.7); }
  .subnet.private-app .subnet-label { color: rgba(0, 255, 157, 0.7); }
  .subnet.private-db .subnet-label { color: rgba(255, 107, 53, 0.7); }

  .az-tag {
    font-size: 0.55rem;
    opacity: 0.5;
    font-weight: 400;
  }

  /* ===== COMPONENTS ===== */
  .component {
    display: flex;
    align-items: center;
    gap: 10px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 12px;
    margin-bottom: 8px;
    transition: border-color 0.2s, transform 0.2s;
    cursor: default;
  }

  .component:last-child { margin-bottom: 0; }

  .component:hover {
    border-color: rgba(0, 212, 255, 0.4);
    transform: translateX(2px);
  }

  .icon {
    width: 32px;
    height: 32px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    flex-shrink: 0;
  }

  .icon.alb   { background: rgba(0,212,255,0.12); }
  .icon.ecs   { background: rgba(0,255,157,0.12); }
  .icon.rds   { background: rgba(255,107,53,0.12); }
  .icon.ecr   { background: rgba(168,85,247,0.12); }
  .icon.s3    { background: rgba(255,193,7,0.12); }
  .icon.sm    { background: rgba(236,72,153,0.12); }
  .icon.cw    { background: rgba(99,179,237,0.12); }
  .icon.ep    { background: rgba(148,163,184,0.12); }
  .icon.inet  { background: rgba(0,212,255,0.15); }
  .icon.as    { background: rgba(0,255,157,0.1); }

  .comp-info { flex: 1; min-width: 0; }

  .comp-name {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.76rem;
    font-weight: 600;
    color: var(--text);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .comp-desc {
    font-size: 0.68rem;
    color: var(--muted);
    margin-top: 2px;
    line-height: 1.3;
  }

  .badge {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.56rem;
    padding: 2px 6px;
    border-radius: 4px;
    font-weight: 600;
    white-space: nowrap;
    flex-shrink: 0;
  }

  .badge.fargate { background: rgba(0,255,157,0.12); color: #00ff9d; border: 1px solid rgba(0,255,157,0.2); }
  .badge.multiaz { background: rgba(255,107,53,0.12); color: #ff8c5a; border: 1px solid rgba(255,107,53,0.2); }
  .badge.gw      { background: rgba(148,163,184,0.1); color: #94a3b8; border: 1px solid rgba(148,163,184,0.2); }
  .badge.iface   { background: rgba(168,85,247,0.1); color: #c084fc; border: 1px solid rgba(168,85,247,0.2); }
  .badge.pg17    { background: rgba(255,107,53,0.12); color: #ff8c5a; border: 1px solid rgba(255,107,53,0.2); }

  /* ===== ARROWS / CONNECTORS ===== */
  .connector {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 4px 0;
    gap: 8px;
  }

  .arrow-line {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
  }

  .arrow-shaft {
    width: 2px;
    height: 20px;
    background: linear-gradient(to bottom, var(--accent), transparent);
    opacity: 0.5;
  }

  .arrow-head {
    width: 0;
    height: 0;
    border-left: 5px solid transparent;
    border-right: 5px solid transparent;
    border-top: 7px solid var(--accent);
    opacity: 0.5;
  }

  .conn-label {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.6rem;
    color: var(--muted);
    letter-spacing: 0.08em;
  }

  /* ===== INTERNET BOX ===== */
  .internet-box {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-bottom: 16px;
  }

  .inet-pill {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(0, 212, 255, 0.07);
    border: 1px solid rgba(0, 212, 255, 0.2);
    border-radius: 50px;
    padding: 8px 20px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.75rem;
    color: var(--accent);
  }

  /* ===== SERVICES ROW (outside VPC) ===== */
  .external-services {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    margin-top: 16px;
  }

  .ext-service {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: border-color 0.2s;
  }

  .ext-service:hover { border-color: rgba(168, 85, 247, 0.4); }

  .ext-label {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--text);
  }

  .ext-sub {
    font-size: 0.63rem;
    color: var(--muted);
    margin-top: 1px;
  }

  /* ===== LEGEND ===== */
  .legend {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.68rem;
    color: var(--muted);
    font-family: 'IBM Plex Mono', monospace;
  }

  .legend-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
  }

  /* ===== SECTION DIVIDER ===== */
  .section-divider {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 8px 0;
  }

  .divider-line {
    flex: 1;
    height: 1px;
    background: var(--border);
    opacity: 0.5;
  }

  .divider-text {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.6rem;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }

  /* ===== MULTI-AZ DISPLAY ===== */
  .az-columns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  .az-col {
    border-radius: 8px;
    padding: 10px;
  }

  .az-col.az-a {
    background: var(--az1);
    border: 1px dashed rgba(0, 212, 255, 0.15);
  }

  .az-col.az-b {
    background: var(--az2);
    border: 1px dashed rgba(168, 85, 247, 0.15);
  }

  .az-header {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.58rem;
    font-weight: 600;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .az-col.az-a .az-header { color: rgba(0, 212, 255, 0.5); }
  .az-col.az-b .az-header { color: rgba(168, 85, 247, 0.5); }

  .flow-arrows {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 16px;
  }

  .flow-path {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
  }

  .flow-label {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.58rem;
    color: var(--muted);
  }

  .flow-arrow {
    font-size: 0.9rem;
    opacity: 0.4;
  }

  .fa-down { color: var(--accent); }
  .fa-right { color: var(--accent3); }

  /* Animations */
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .vpc, .external-services, .internet-box {
    animation: fadeInUp 0.5s ease both;
  }

  .tier-row:nth-child(1) { animation-delay: 0.1s; }
  .tier-row:nth-child(2) { animation-delay: 0.2s; }
  .tier-row:nth-child(3) { animation-delay: 0.3s; }
</style>
</head>
<body>

<header>
  <h1>Wiki.js ¬∑ AWS Architecture</h1>
  <p>Three-tier ¬∑ Fargate ¬∑ Multi-AZ ¬∑ Zero-Trust Networking</p>
</header>

<div class="diagram">

  <!-- Internet -->
  <div class="internet-box">
    <div class="inet-pill">
      <span>üåê</span>
      <span>Internet / Users</span>
    </div>
  </div>

  <!-- Arrow down to ALB -->
  <div class="connector">
    <div class="arrow-line">
      <div class="arrow-shaft"></div>
      <div class="arrow-head"></div>
    </div>
    <span class="conn-label">port 80 / 443</span>
  </div>

  <!-- VPC -->
  <div class="vpc">
    <span class="zone-label">AWS VPC ‚Äî Custom</span>

    <!-- WEB TIER: Public Subnets -->
    <div class="section-divider">
      <div class="divider-line"></div>
      <span class="divider-text">Web Tier ‚Äî Public Subnets</span>
      <div class="divider-line"></div>
    </div>

    <div class="az-columns" style="margin-bottom: 14px;">
      <div class="az-col az-a">
        <div class="az-header">‚¨° AZ-1a</div>
        <div class="component">
          <div class="icon alb">‚öñÔ∏è</div>
          <div class="comp-info">
            <div class="comp-name">ALB ‚Äî Public</div>
            <div class="comp-desc">Internet-facing ¬∑ health checks</div>
          </div>
        </div>
      </div>
      <div class="az-col az-b">
        <div class="az-header">‚¨° AZ-1b</div>
        <div class="component">
          <div class="icon alb">‚öñÔ∏è</div>
          <div class="comp-info">
            <div class="comp-name">ALB ‚Äî Public</div>
            <div class="comp-desc">Cross-AZ load balancing</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Arrow -->
    <div class="connector">
      <div class="arrow-line">
        <div class="arrow-shaft" style="background: linear-gradient(to bottom, var(--accent3), transparent);"></div>
        <div class="arrow-head" style="border-top-color: var(--accent3);"></div>
      </div>
      <span class="conn-label">target group forwarding</span>
    </div>

    <!-- APP TIER: Private Subnets -->
    <div class="section-divider">
      <div class="divider-line"></div>
      <span class="divider-text">Application Tier ‚Äî Private Subnets</span>
      <div class="divider-line"></div>
    </div>

    <div class="az-columns" style="margin-bottom: 14px;">
      <div class="az-col az-a">
        <div class="az-header">‚¨° AZ-1a</div>
        <div class="component">
          <div class="icon ecs">üê≥</div>
          <div class="comp-info">
            <div class="comp-name">ECS Fargate Task</div>
            <div class="comp-desc">Wiki.js container</div>
          </div>
          <span class="badge fargate">FARGATE</span>
        </div>
        <div class="component">
          <div class="icon as">üìà</div>
          <div class="comp-info">
            <div class="comp-name">Auto Scaling</div>
            <div class="comp-desc">CPU target tracking</div>
          </div>
        </div>
      </div>
      <div class="az-col az-b">
        <div class="az-header">‚¨° AZ-1b</div>
        <div class="component">
          <div class="icon ecs">üê≥</div>
          <div class="comp-info">
            <div class="comp-name">ECS Fargate Task</div>
            <div class="comp-desc">Wiki.js container</div>
          </div>
          <span class="badge fargate">FARGATE</span>
        </div>
        <div class="component">
          <div class="icon ep">üîó</div>
          <div class="comp-info">
            <div class="comp-name">VPC Endpoints</div>
            <div class="comp-desc">ECR ¬∑ S3 ¬∑ Secrets Mgr</div>
          </div>
          <span class="badge iface">PRIVATE</span>
        </div>
      </div>
    </div>

    <!-- Arrow -->
    <div class="connector">
      <div class="arrow-line">
        <div class="arrow-shaft" style="background: linear-gradient(to bottom, var(--accent2), transparent);"></div>
        <div class="arrow-head" style="border-top-color: var(--accent2);"></div>
      </div>
      <span class="conn-label">port 5432 (SG: ECS tasks only)</span>
    </div>

    <!-- DATA TIER: Private Subnets -->
    <div class="section-divider">
      <div class="divider-line"></div>
      <span class="divider-text">Data Tier ‚Äî Private Subnets</span>
      <div class="divider-line"></div>
    </div>

    <div class="az-columns">
      <div class="az-col az-a">
        <div class="az-header">‚¨° AZ-1a ‚Äî Primary</div>
        <div class="component">
          <div class="icon rds">üóÑÔ∏è</div>
          <div class="comp-info">
            <div class="comp-name">RDS PostgreSQL 17</div>
            <div class="comp-desc">Primary instance</div>
          </div>
          <span class="badge pg17">PG17</span>
        </div>
      </div>
      <div class="az-col az-b">
        <div class="az-header">‚¨° AZ-1b ‚Äî Standby</div>
        <div class="component">
          <div class="icon rds">üóÑÔ∏è</div>
          <div class="comp-info">
            <div class="comp-name">RDS PostgreSQL 17</div>
            <div class="comp-desc">Multi-AZ standby replica</div>
          </div>
          <span class="badge multiaz">MULTI-AZ</span>
        </div>
      </div>
    </div>

  </div><!-- /vpc -->

  <!-- External AWS Services -->
  <div style="margin-top: 6px;">
    <div class="section-divider">
      <div class="divider-line"></div>
      <span class="divider-text">AWS Managed Services (via VPC Endpoints ‚Äî no NAT)</span>
      <div class="divider-line"></div>
    </div>
    <div class="external-services">
      <div class="ext-service">
        <div class="icon ecr" style="font-size:0.9rem;">üì¶</div>
        <div>
          <div class="ext-label">Amazon ECR</div>
          <div class="ext-sub">Container images</div>
        </div>
      </div>
      <div class="ext-service">
        <div class="icon s3" style="font-size:0.9rem;">ü™£</div>
        <div>
          <div class="ext-label">Amazon S3</div>
          <div class="ext-sub">Config / assets</div>
        </div>
      </div>
      <div class="ext-service">
        <div class="icon sm" style="font-size:0.9rem;">üîê</div>
        <div>
          <div class="ext-label">Secrets Manager</div>
          <div class="ext-sub">DB credentials</div>
        </div>
      </div>
      <div class="ext-service">
        <div class="icon cw" style="font-size:0.9rem;">üìä</div>
        <div>
          <div class="ext-label">CloudWatch</div>
          <div class="ext-sub">Logs & metrics</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Legend -->
  <div class="legend">
    <div class="legend-item"><div class="legend-dot" style="background:rgba(0,212,255,0.6)"></div>Public Subnet</div>
    <div class="legend-item"><div class="legend-dot" style="background:rgba(0,255,157,0.6)"></div>Private App Subnet</div>
    <div class="legend-item"><div class="legend-dot" style="background:rgba(255,107,53,0.6)"></div>Private DB Subnet</div>
    <div class="legend-item"><div class="legend-dot" style="background:rgba(168,85,247,0.6)"></div>Managed AWS Services</div>
    <div class="legend-item">üîí Zero-trust networking ¬∑ no NAT gateway ¬∑ least-privilege SGs</div>
  </div>

</div><!-- /diagram -->

</body>
</html>
